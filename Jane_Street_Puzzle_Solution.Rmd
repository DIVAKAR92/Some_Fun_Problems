---
title: "Jane Street Puzzle Solution"
author: "Divakar Kumar"
date: "29/05/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem Statement :

There are 10 castles, numbered 1, 2, 3, ... , 10, and worth 1, 2, 3, ... , 10 points respectively. You have 100 soldiers, which you can allocate
between the castles however you wish. Your opponent also (independently) does the same. The number of soldiers on each castle is then
compared, and for each castle, whoever has the most soldiers on that castle wins its points (in the case of a tie, no one gets points).

```{r , echo=FALSE, results='asis'}
library(knitr)
df = data.frame(Castle = c("Alice", "Carol"), C1 = c(10,20),
                C2 = c(10,0), C3 = c(10,10), C4 = c(10,5),
                C5 = c(10,10), C6 =c(10,5), C7 = c(10,10),
                C8 = c(10,20), C9 =c(10,0), C10 = c(10,20))
kable(df)
```

In this match, Alice wins castles 2, 4, 6, 9, for a total of 21 points, and Carol wins castles 1, 8, 10, for a total of 19 points (no one wins
castles 3, 5, 7).
We're going to play a tournament. You get one entry and your final score is the average of your scores playing head-to-head against entries
from several hundred Jane Streeters. An entry should be submitted as a list of 10 non-negative integers, adding up to 100, where the nth
element is the number of units of resources being sent to region n.
What's your entry? How did you go about coming up with it?
How would your entry change if you were only allowed 90 soldiers? What about if you received 110 resources? (In both cases everyone else
still gets 100).

## My approach and solution

### Maximum possible points won by a player and winning threshold 
A player can win maximum number of points, if her opponent arranges soldiers like 
```{r , echo=FALSE, results='asis'}
library(knitr)
df = data.frame(Castle = c("Opponent", "Given player"), C1 = c(100, "a1"),
                C2 = c(0,"a2"), C3 = c(0, "a3"), C4 = c(0, "a4"),
                C5 = c(0, "a5"), C6 =c(0, "a6"), C7 = c(0, "a7"),
                C8 = c(0, "a8"), C9 =c(0, "a9"), C10 = c(0, "a10"))
kable(df)
```

This player wins the maximum number of points as long as $$a_i \geq 1, \mbox{ for all } i \in \{1,2...10\}$$ such that they sum to 100. Under this restriction, the player loses in C1 while wins in the remaining ones. This results into a total of $$(1+...+10)-1=54$$ points. Therefore, the player will be able to win if she scores 28 or more points. 

## My winning strategy
It can be observed that if a player wins the following cobinations of castles $\{C2,C3,C4,C5,C6,C8\}$; this accumulates them a total of $2+3+5+4+6+8 = 28$ points. (**Note: There can be other combinations of castles which sums to 28 for example $\{C1,C2,C3,C4,C5,C6,C7\}$ or $\{C3,C4,C5,C6,C10\}$, however my choice of $\{C2,C3,C4,C5,C6,C8\}$ was made keeping in mind that castles with very large and very low points are ignored.**)  Moreover, I allocate soldiers to castles $\{C2,C3,C4,C5,C6,C8\}$ proportinal to the points contributed towards the total. I plan to give more weightage to castles carrying more points, therefore I distribute points to the castles according to the function $f(x) \propto x^2$ where $x$ is the number of points that a castle carry. However, my strategy is to use only $90\%$ of the resources for castles $\{C2,C3,C4,C5,C6,C8\}$. Therefore, as per above restrictions I allocate 90 soldiers according to the following formula $$\mbox{Soldiers in Castle } i = \frac{i^2}{2^2+3^2+4^2+5^2+6^2+8^2}\times 90$$ for $i \in \{2,3,4,5,6,8\}$. The following function in $\texttt{R}$ carries the task of resource allocation according to the above strategy:
```{r, echo=TRUE}
square_strategy = function(castles, resource = 90){
  round(castles^2/(sum(castles^2))*resource)
}
# soldiers sent to castles 2,3,4,5,6 and 8
square_strategy(c(2,3,4,5,6,8),90)
```
It can be observed that due to rounding of numbers the total number of soldiers is 89 thus I allocate the remaining 1 soldier to castle $C2$. Next, remaining 10 soldiers are allocated to  castles $\{C1,C7,C9,C10\}$ by sending $1,3,3,3$ soldiers respectively. The last allocation gives an edge in case opponent ignores these cells or allocates very-very few soldiers. 

```{r , echo=FALSE, results='asis'}
library(knitr)
win_strategy = data.frame(Castle = c("My strategy 100","My strategy 110","My strategy 90"), C1 = c(1),
                C2 = c(3), C3 = c(5), C4 = c(9),
                C5 = c(15), C6 =c(21), C7 = c(3),
                C8 = c(37), C9 =c(3), C10 = c(3))
win_strategy$Castle[2:3] = c("My strategy 110","My strategy 90")
win_strategy[2,2:11] = win_strategy[1,2:11] + 1
win_strategy[3,2:11] = win_strategy[1,2:11] - 1
win_strategy$Total = c(100,110,90)
kable(win_strategy[1,])

```


#### When the total number of soldiers is 110
When I am given 110 soldiers to distribute among the castles, I would send 1 extra soldier to each castle. Therefore the soldier allocation can be done as follows:

```{r , echo=FALSE, results='asis'}
library(knitr)
win_strategy = data.frame(Castle = c("My strategy 110"), C1 = c(1),
                C2 = c(3), C3 = c(5), C4 = c(9),
                C5 = c(15), C6 =c(21), C7 = c(3),
                C8 = c(37), C9 =c(3), C10 = c(3))
win_strategy[1,2:11] = win_strategy[1,2:11] + 1
win_strategy$Total = c(110)
kable(win_strategy)

```

#### When the total number of soldiers is 90
At the same time when I have 90 soldiers to work with, I would use the same strategy as in the case of 100 soldiers except for the fact that the castle using highest number of soldiers receives 10 less soldiers this time. In this case I would send only 27 soldiers to castle $C8$ while keeping others fixed. This has been listed in the table below.

```{r , echo=FALSE, results='asis'}
library(knitr)
win_strategy = data.frame(Castle = c("My strategy 90"), C1 = c(1),
                C2 = c(3), C3 = c(5), C4 = c(9),
                C5 = c(15), C6 =c(21), C7 = c(3),
                C8 = c(27), C9 =c(3), C10 = c(3))

win_strategy$Total = c(90)
kable(win_strategy)

```



